/*
  zombidice v0.1.3

  http://github.com/zombicide
*/

var zombidiceApp=angular.module("zombidiceApp",[]);zombidiceApp.service("mathService",function(){this.Prb=function(a){return a=0>a?0:a,a>1?1:a},this.PosV=function(a){return 0>a?-a:a},this.Fact=function(a){for(var b=1;a>1;)b*=a--;return b},this.LnFact=function(a){if(1>=a&&(a=1),12>a)return Math.log(this.Fact(Math.round(a)));var b=1/a,c=b*b,d=c*b,e=d*c,f=e*c,g=(a+.5)*Math.log(a)-a;return g+=Math.log(2*Math.PI)/2,g+=b/12-d/360,g+=e/1260-f/1680},this.LnComb=function(a,b){return 0===b||b===a?0:b>a||0>b?-1e38:this.LnFact(a)-this.LnFact(b)-this.LnFact(a-b)},this.BinomTerm=function(a,b,c){return Math.exp(this.LnComb(b,c)+c*Math.log(a)+(b-c)*Math.log(1-a))},this.BinomialDistribution=function(a,b,c){return c>b&&(c=b),this.BinomTerm(a,b,c)}}),zombidiceApp.controller("ZombidiceCtrl",["$scope","mathService",function(a,b){function c(a){return(7-a.hitpoints)/6}a.zombies={walkers:2,runners:1,fatties:1},a.weapons=[{id:"pan",type:"close",name:"Pan",min_distance:0,max_distance:0,dice:1,hitpoints:6,damage:1},{id:"crowbar",type:"close",name:"Crowbar",min_distance:0,max_distance:0,dice:1,hitpoints:4,damage:1},{id:"fire_axe",type:"close",name:"Fire axe",min_distance:0,max_distance:0,dice:1,hitpoints:4,damage:2},{id:"machete",type:"close",name:"Machete","double":!0,min_distance:0,max_distance:0,dice:1,hitpoints:4,damage:2},{id:"baseball_bat",type:"close",name:"Baseball bat",min_distance:0,max_distance:0,dice:1,hitpoints:3,damage:2},{id:"katana",type:"close",name:"Katana",min_distance:0,max_distance:0,dice:2,hitpoints:4,damage:1},{id:"chainsaw",type:"close",name:"Chainsaw",min_distance:0,max_distance:0,dice:5,hitpoints:5,damage:2},{id:"pistol",type:"gun",name:"Pistol","double":!0,min_distance:0,max_distance:1,dice:1,hitpoints:4,damage:1},{id:"shotgun",type:"gun",name:"Shotgun",min_distance:0,max_distance:1,dice:2,hitpoints:4,damage:2},{id:"sawed_off",type:"gun",name:"Sawed off","double":!0,min_distance:0,max_distance:1,dice:2,hitpoints:3,damage:1},{id:"sub_mg",type:"gun",name:"Sub MG","double":!0,min_distance:0,max_distance:1,dice:3,hitpoints:5,damage:1},{id:"rifle",type:"gun",name:"Rifle",min_distance:0,max_distance:3,dice:1,hitpoints:3,damage:1},{id:"ma_shotgun_blade",type:"special",name:"Ma's shotgun (blade)",min_distance:0,max_distance:1,dice:1,hitpoints:3,damage:2},{id:"ma_shotgun_gun",type:"special",name:"Ma's shotgun (gun)",min_distance:0,max_distance:1,dice:2,hitpoints:3,damage:2},{id:"evil_twins",type:"special",name:"Evil twins",min_distance:0,max_distance:1,dice:2,hitpoints:4,damage:1},{id:"molotov_cocktail",type:"special",name:"Molotov Cocktail",min_distance:0,max_distance:1,dice:1,hitpoints:null,damage:null,probableKills:[100]}],a.selected=[],a.deadliestWeapon=void 0,a.safestWeapon=void 0,a.addZombie=function(b){a.zombies[b]+=1},a.removeZombie=function(b){a.zombies[b]>0&&(a.zombies[b]-=1)},a.zombiesCount=function(){for(var b=0,c=a.zombies.walkers+a.zombies.runners,d=0;d<a.selected.length;d++)a.selected[d].damage>b&&(b=a.selected[d].damage);return b>1?c+a.zombies.fatties:c},a.toggleWeapon=function(b){var c=a.selected.indexOf(b);-1===c?(a.selected.push(b),a.selected.sort(function(a,b){return a.name>b.name}),b.selected=!0):(a.selected.splice(c,1),b.selected=!1)},a.getDeadliestWeapon=function(){if(!a.selected.length)return void 0;for(var b=0,c=0,d=0,e=0;e<a.selected.length;e++)a.selected[e].dice>b?(b=a.selected[e].dice,c=e):a.selected[e].probableKills?a.selected[e].probableKills[b]>a.selected[c].probableKills[b]&&(c=e,d+=1):a.probableKills(a.selected[e]);return d==a.selected.length?a.getSafestWeapon():a.selected[c].name},a.getSafestWeapon=function(){if(!a.selected.length)return void 0;for(var b=0,c=0,d=0;d<a.selected.length;d++)a.selected[d].probableKills||a.probableKills(a.selected[d]),a.selected[d].probableKills[0]>c&&(b=d,c=a.selected[d].probableKills[0]);return a.selected[b].name},a.probableKills=function(d){if(void 0===d.probableKills){for(var e=[],f=c(d),g=d.dice;g>0;g--){var h=b.BinomialDistribution(f,d.dice,g);pkill=100*h+(e[d.dice-g-1]||0),e.push(pkill)}d.probableKills=e.reverse()}return a.deadliestWeapon=a.getDeadliestWeapon(),a.safestWeapon=a.getSafestWeapon(),d.probableKills}}]);
//# sourceMappingURL=zombidice.min.map